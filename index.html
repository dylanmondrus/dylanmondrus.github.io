<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>76ac19e4e2d14f5ba9383314843f7068</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="congestion-relief-zone-data-analysis" class="cell markdown"
id="mln1-9z5zG-a">
<h1>Congestion Relief Zone Data Analysis</h1>
<p>Dylan Mondrus and Ryan Fenner</p>
<p><a href="https://dylanmondrus.github.io">Link to Webpage</a></p>
</section>
<section id="project-goals" class="cell markdown" id="SnXB8xA-iHDW">
<h1>Project Goals</h1>
</section>
<div class="cell markdown" id="lPodJVptlaLa">
<p>The objective of this project is to assess the impact of the 2025
implementation of New York City's Congestion Relief Zone on traffic
volume south of 60th Street.</p>
</div>
<div class="cell markdown" id="5gQN9SRBNJ-B">
<p>Essential Questions:</p>
<ul>
<li>Has the Congestion Relief Zone accomplished its goal of reducing
overall traffic congestion in lower Manhattan?</li>
<li>What regions have seen the most relief?</li>
<li>What trends about NYC traffic over time can we identify to predict
the growth of traffic in the future?</li>
</ul>
</div>
<section id="project-dataset" class="cell markdown" id="b60owIgdiY7C">
<h1>Project Dataset</h1>
</section>
<div class="cell markdown" id="KOMfc4Mi2F1R">
<p>The data we are interested in working with currently is all the data
associated with the implementation of the Congestion Relief Zone
implemented in January 2025 in New York City. The <a
href="https://data.ny.gov/Transportation/MTA-Congestion-Relief-Zone-Vehicle-Entries-Beginni/t6yz-b64h/about_data">MTA
Congestion Relief Zone Vehicle Entries: Beginning 2025</a>. I have
accessed the data collected by the MTA for the last two months which
details the number of entries into the zone at a given time(day, hour,
minute, 10 minute interval). This dataset may be good for tracking the
trend of entries into the zone over the course of the timeline since
it's been implemented. We also have the traffic volume from the <a
href="https://data.cityofnewyork.us/Transportation/Traffic-Volume-Counts/btm5-ppia/about_data">Traffic
Volume Counts</a> dataset created by the Department of
Transportation.</p>
<p>This may answer questions like: How has rush hour traffic changed
since its implementation? How much has traffic volume changed since its
implementation? Which entry points have increased their traffic volume
since its implementation? These are all good questions but cannot give
the full picture of the CRZ's effectiveness unless we get larger and
more datasets. I'm looking for similar traffic data from before the CRZ
so we can answer the same questions but with a larger timeframe in mind
so we can truly visualize the effectiveness.</p>
<p>Currently we have data from 2025 on and from May 27, 2022 and before.
While there is a three year gap in the data from 2022 to 2025, we should
be able to use regression to calculate expected values for the missing
years. Otherwise we will find more datasets to fill in the data. Even
so, whether or not the congestion zones affect traffic should be clear
based on our analysis of before and after implementation.</p>
</div>
<section id="collaboration-plan" class="cell markdown"
id="yuRbrD6amDrS">
<h1>Collaboration Plan</h1>
</section>
<div class="cell markdown" id="RHj4oCuKmH50">
<p>Our collaboration plan is to meet at the library once a week to
continue towards completion on the final project. We have created and
shared a google colab to work on and update our code together. From now
until April 18th we will continue scraping each traffic dataset we find
to create good comparisons between them. We also hope to find another
dataset from the most current data available. From April 18 to May 8th
we will develop our presentation using the key graphs and insights found
during the ETL phase.</p>
</div>
<section id="etl-extraction-transform-and-load" class="cell markdown"
id="m2-NdmPJuKfv">
<h1>ETL (Extraction, Transform, and Load)</h1>
</section>
<div class="cell markdown" id="sneySwSnuQUp">
<p>We currently have 2 dataset excel files loaded. The 2025
post-congestion zone dataset, and the total traffic volume data prior to
2022. The 2025 dataset contains exact time of tole, vehicle class, entry
location, entry region, CRZ entries, and excluded roadway entries. The
total traffic dataset contains exact location of detection, direction,
and amount of vehicles detected.</p>
</div>
<section id="interesting-statistics" class="cell markdown"
id="NZbdTNqLqCMj">
<h1>Interesting statistics</h1>
<ul>
<li>the day with the least amount of entries into the CRZ was Sunday,
January 19th.</li>
<li>The average entries into the CRZ per day is 477,525.</li>
<li>The detection region with the most entries is Brookyln. This means
that Brooklyn has more people driving into lower manhattan than any
other region.</li>
</ul>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="qhuvnVuovBeW" data-outputId="0cc4b8a3-d492-42ff-80ec-e8e8873dadbd">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">&#39;/content/drive&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Mounted at /content/drive
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="hoEfSUUBlqNv" data-outputId="50ebf7be-f28a-4cae-ecab-68954e98f01e">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>git clone https:<span class="op">//</span>github.com<span class="op">/</span>dylanmondrus<span class="op">/</span>dylanmondrus.github.io</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Cloning into &#39;dylanmondrus.github.io&#39;...
remote: Enumerating objects: 21, done.ote: Counting objects: 100% (21/21), done.ote: Compressing objects: 100% (15/15), done.ote: Total 21 (delta 3), reused 20 (delta 2), pack-reused 0 (from 0)</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:630}"
id="ZvvSl48Mp4ra" data-outputId="86595fcd-e297-4b16-ddc4-ab4e75209847">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>CRZ_df <span class="op">=</span> pd.read_csv(<span class="st">&quot;https://raw.githubusercontent.com/dylanmondrus/dylanmondrus.github.io/refs/heads/main/MTA_Congestion_Relief_Zone_Vehicle_Entries__Beginning_2025_20250311.csv&quot;</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>CRZ_grouped <span class="op">=</span> CRZ_df.groupby(<span class="st">&#39;Toll Date&#39;</span>)[<span class="st">&#39;CRZ Entries&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>plt.bar(CRZ_grouped[<span class="st">&#39;Toll Date&#39;</span>], CRZ_grouped[<span class="st">&#39;CRZ Entries&#39;</span>], width<span class="op">=</span><span class="fl">1.0</span>, edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Date&#39;</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;CRZ Entries&#39;</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;CRZ Entries Over Time&#39;</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_4d12ce75fe99437cb0cb3ffc5455800b/0c4576bc38a22737a5fd46e1bb0f5a156a6c3201.png" /></p>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:345}"
id="EPr7_bp4j7gj" data-outputId="9a6f960c-94c5-41e7-bcb7-9ca4a4e4a187">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>CRZ_df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="8">

  <div id="df-23d02234-f4ac-42d5-a1c2-930caa8bdb6b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Toll Date</th>
      <th>Toll Hour</th>
      <th>Toll 10 Minute Block</th>
      <th>Minute of Hour</th>
      <th>Hour of Day</th>
      <th>Day of Week Int</th>
      <th>Day of Week</th>
      <th>Toll Week</th>
      <th>Time Period</th>
      <th>Vehicle Class</th>
      <th>Detection Group</th>
      <th>Detection Region</th>
      <th>CRZ Entries</th>
      <th>Excluded Roadway Entries</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>03/01/2025</td>
      <td>03/01/2025 11:00:00 PM</td>
      <td>03/01/2025 11:50:00 PM</td>
      <td>50</td>
      <td>23</td>
      <td>7</td>
      <td>Saturday</td>
      <td>02/23/2025</td>
      <td>Overnight</td>
      <td>4 - Buses</td>
      <td>Brooklyn Bridge</td>
      <td>Brooklyn</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>03/01/2025</td>
      <td>03/01/2025 11:00:00 PM</td>
      <td>03/01/2025 11:50:00 PM</td>
      <td>50</td>
      <td>23</td>
      <td>7</td>
      <td>Saturday</td>
      <td>02/23/2025</td>
      <td>Overnight</td>
      <td>TLC Taxi/FHV</td>
      <td>West Side Highway at 60th St</td>
      <td>West Side Highway</td>
      <td>138</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>03/01/2025</td>
      <td>03/01/2025 11:00:00 PM</td>
      <td>03/01/2025 11:50:00 PM</td>
      <td>50</td>
      <td>23</td>
      <td>7</td>
      <td>Saturday</td>
      <td>02/23/2025</td>
      <td>Overnight</td>
      <td>TLC Taxi/FHV</td>
      <td>West 60th St</td>
      <td>West 60th St</td>
      <td>201</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>03/01/2025</td>
      <td>03/01/2025 11:00:00 PM</td>
      <td>03/01/2025 11:50:00 PM</td>
      <td>50</td>
      <td>23</td>
      <td>7</td>
      <td>Saturday</td>
      <td>02/23/2025</td>
      <td>Overnight</td>
      <td>TLC Taxi/FHV</td>
      <td>Queensboro Bridge</td>
      <td>Queens</td>
      <td>83</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>03/01/2025</td>
      <td>03/01/2025 11:00:00 PM</td>
      <td>03/01/2025 11:50:00 PM</td>
      <td>50</td>
      <td>23</td>
      <td>7</td>
      <td>Saturday</td>
      <td>02/23/2025</td>
      <td>Overnight</td>
      <td>TLC Taxi/FHV</td>
      <td>Queens Midtown Tunnel</td>
      <td>Queens</td>
      <td>119</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-23d02234-f4ac-42d5-a1c2-930caa8bdb6b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-23d02234-f4ac-42d5-a1c2-930caa8bdb6b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-23d02234-f4ac-42d5-a1c2-930caa8bdb6b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-82405ae9-60d9-4e77-afd8-a3c6f6d28c95">
      <button class="colab-df-quickchart" onclick="quickchart('df-82405ae9-60d9-4e77-afd8-a3c6f6d28c95')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-82405ae9-60d9-4e77-afd8-a3c6f6d28c95 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
</div>
<section id="before-and-after-data-comparison" class="cell markdown"
id="3Uy5dAJiw31R">
<h1>Before and After Data Comparison</h1>
</section>
<div class="cell markdown" id="prbJmPdow9iF">
<p>In the total traffic volume dataset, we are able to view the traffic
of the entire city of New York. We will filter this to data specifically
from the congestion zone, and be able to compare the amount of entries
between the two datasets.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:826}"
id="SY63gNqRkby1" data-outputId="357bbc92-06d3-4444-d7f0-90d8f137bd33">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>traffic_df <span class="op">=</span> pd.read_csv(<span class="st">&quot;https://raw.githubusercontent.com/dylanmondrus/dylanmondrus.github.io/refs/heads/main/Traffic_Volume_Counts_20250311.csv&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>traffic_df</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">

  <div id="df-ebe51e03-8304-458d-958c-57689ab4cb07" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>SegmentID</th>
      <th>Roadway Name</th>
      <th>From</th>
      <th>To</th>
      <th>Direction</th>
      <th>Date</th>
      <th>12:00-1:00 AM</th>
      <th>1:00-2:00AM</th>
      <th>2:00-3:00AM</th>
      <th>...</th>
      <th>2:00-3:00PM</th>
      <th>3:00-4:00PM</th>
      <th>4:00-5:00PM</th>
      <th>5:00-6:00PM</th>
      <th>6:00-7:00PM</th>
      <th>7:00-8:00PM</th>
      <th>8:00-9:00PM</th>
      <th>9:00-10:00PM</th>
      <th>10:00-11:00PM</th>
      <th>11:00-12:00AM</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>15540</td>
      <td>BEACH STREET</td>
      <td>UNION PLACE</td>
      <td>VAN DUZER STREET</td>
      <td>NB</td>
      <td>01/09/2012</td>
      <td>20.0</td>
      <td>10.0</td>
      <td>11.0</td>
      <td>...</td>
      <td>104.0</td>
      <td>105.0</td>
      <td>147.0</td>
      <td>120.0</td>
      <td>91.0</td>
      <td>83.0</td>
      <td>74.0</td>
      <td>49.0</td>
      <td>42.0</td>
      <td>42.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>15540</td>
      <td>BEACH STREET</td>
      <td>UNION PLACE</td>
      <td>VAN DUZER STREET</td>
      <td>NB</td>
      <td>01/10/2012</td>
      <td>21.0</td>
      <td>16.0</td>
      <td>8.0</td>
      <td>...</td>
      <td>102.0</td>
      <td>98.0</td>
      <td>133.0</td>
      <td>131.0</td>
      <td>95.0</td>
      <td>73.0</td>
      <td>70.0</td>
      <td>63.0</td>
      <td>42.0</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>15540</td>
      <td>BEACH STREET</td>
      <td>UNION PLACE</td>
      <td>VAN DUZER STREET</td>
      <td>NB</td>
      <td>01/11/2012</td>
      <td>27.0</td>
      <td>14.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>115.0</td>
      <td>115.0</td>
      <td>130.0</td>
      <td>143.0</td>
      <td>106.0</td>
      <td>89.0</td>
      <td>68.0</td>
      <td>64.0</td>
      <td>56.0</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>15540</td>
      <td>BEACH STREET</td>
      <td>UNION PLACE</td>
      <td>VAN DUZER STREET</td>
      <td>NB</td>
      <td>01/12/2012</td>
      <td>22.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>71.0</td>
      <td>127.0</td>
      <td>122.0</td>
      <td>144.0</td>
      <td>122.0</td>
      <td>76.0</td>
      <td>64.0</td>
      <td>58.0</td>
      <td>64.0</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>15540</td>
      <td>BEACH STREET</td>
      <td>UNION PLACE</td>
      <td>VAN DUZER STREET</td>
      <td>NB</td>
      <td>01/13/2012</td>
      <td>31.0</td>
      <td>17.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>113.0</td>
      <td>126.0</td>
      <td>133.0</td>
      <td>135.0</td>
      <td>102.0</td>
      <td>106.0</td>
      <td>58.0</td>
      <td>58.0</td>
      <td>55.0</td>
      <td>54.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>42751</th>
      <td>373</td>
      <td>35832</td>
      <td>WEST 49th STREET</td>
      <td>Rockefeller Plaza</td>
      <td>6th Avenue</td>
      <td>WB</td>
      <td>11/18/2020</td>
      <td>68.0</td>
      <td>63.0</td>
      <td>31.0</td>
      <td>...</td>
      <td>152.0</td>
      <td>177.0</td>
      <td>162.0</td>
      <td>164.0</td>
      <td>183.0</td>
      <td>173.0</td>
      <td>143.0</td>
      <td>113.0</td>
      <td>127.0</td>
      <td>133.0</td>
    </tr>
    <tr>
      <th>42752</th>
      <td>373</td>
      <td>35832</td>
      <td>WEST 49th STREET</td>
      <td>Rockefeller Plaza</td>
      <td>6th Avenue</td>
      <td>WB</td>
      <td>11/19/2020</td>
      <td>71.0</td>
      <td>59.0</td>
      <td>42.0</td>
      <td>...</td>
      <td>166.0</td>
      <td>162.0</td>
      <td>187.0</td>
      <td>182.0</td>
      <td>180.0</td>
      <td>190.0</td>
      <td>162.0</td>
      <td>155.0</td>
      <td>234.0</td>
      <td>166.0</td>
    </tr>
    <tr>
      <th>42753</th>
      <td>373</td>
      <td>35832</td>
      <td>WEST 49th STREET</td>
      <td>Rockefeller Plaza</td>
      <td>6th Avenue</td>
      <td>WB</td>
      <td>11/20/2020</td>
      <td>111.0</td>
      <td>79.0</td>
      <td>54.0</td>
      <td>...</td>
      <td>157.0</td>
      <td>186.0</td>
      <td>170.0</td>
      <td>158.0</td>
      <td>194.0</td>
      <td>196.0</td>
      <td>222.0</td>
      <td>174.0</td>
      <td>182.0</td>
      <td>178.0</td>
    </tr>
    <tr>
      <th>42754</th>
      <td>373</td>
      <td>35832</td>
      <td>WEST 49th STREET</td>
      <td>Rockefeller Plaza</td>
      <td>6th Avenue</td>
      <td>WB</td>
      <td>11/21/2020</td>
      <td>129.0</td>
      <td>95.0</td>
      <td>63.0</td>
      <td>...</td>
      <td>139.0</td>
      <td>147.0</td>
      <td>153.0</td>
      <td>183.0</td>
      <td>163.0</td>
      <td>184.0</td>
      <td>183.0</td>
      <td>169.0</td>
      <td>187.0</td>
      <td>211.0</td>
    </tr>
    <tr>
      <th>42755</th>
      <td>373</td>
      <td>35832</td>
      <td>WEST 49th STREET</td>
      <td>Rockefeller Plaza</td>
      <td>6th Avenue</td>
      <td>WB</td>
      <td>11/22/2020</td>
      <td>159.0</td>
      <td>109.0</td>
      <td>77.0</td>
      <td>...</td>
      <td>151.0</td>
      <td>176.0</td>
      <td>152.0</td>
      <td>146.0</td>
      <td>181.0</td>
      <td>177.0</td>
      <td>160.0</td>
      <td>162.0</td>
      <td>147.0</td>
      <td>137.0</td>
    </tr>
  </tbody>
</table>
<p>42756 rows Ã— 31 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ebe51e03-8304-458d-958c-57689ab4cb07')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ebe51e03-8304-458d-958c-57689ab4cb07 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ebe51e03-8304-458d-958c-57689ab4cb07');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-2d4db64e-741a-43d1-b8e1-56ad9b43d4f3">
      <button class="colab-df-quickchart" onclick="quickchart('df-2d4db64e-741a-43d1-b8e1-56ad9b43d4f3')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-2d4db64e-741a-43d1-b8e1-56ad9b43d4f3 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_2179140e-b38a-4e0c-8c67-90288b18e779">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('traffic_df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_2179140e-b38a-4e0c-8c67-90288b18e779 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('traffic_df');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="6H9E5MClpmnK" data-outputId="50cdd328-8495-4f49-9896-e4baea2e34cc">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>min_entry_index <span class="op">=</span> CRZ_grouped[<span class="st">&#39;CRZ Entries&#39;</span>].idxmin()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>min_entry_date <span class="op">=</span> CRZ_grouped.loc[min_entry_index, <span class="st">&#39;Toll Date&#39;</span>]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>min_entry_value <span class="op">=</span> CRZ_grouped.loc[min_entry_index, <span class="st">&#39;CRZ Entries&#39;</span>]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Date with the least CRZ entries: </span><span class="sc">{</span>min_entry_date<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Total entries on this day: </span><span class="sc">{</span>min_entry_value<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Date with the least CRZ entries: 01/19/2025
Total entries on this day: 352701
</code></pre>
</div>
</div>
<section id="monthly-crz-comparison" class="cell markdown"
id="q-sHxGxnx3Ei">
<h1>Monthly CRZ Comparison</h1>
</section>
<div class="cell markdown" id="b4o4rE2tyBbm">
<p>As we can see below, the CRZ exhibits weekly fluctuations in traffic
volume. We can use data like this to see if the patterns still exist
before CRZ implementation and the change in volume of traffic. We can
also look at this data over months or years to see if there is any
significant change in traffic.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:300}"
id="yWUAunY4p8Aq" data-outputId="b51f6992-e674-4bd3-a4ab-62db8e429259">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>CRZ_grouped.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="11">

  <div id="df-348e8786-5efe-4cde-830e-5f45b6617973" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CRZ Entries</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>56.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>477525.589286</td>
    </tr>
    <tr>
      <th>std</th>
      <td>39955.043192</td>
    </tr>
    <tr>
      <th>min</th>
      <td>352701.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>462850.250000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>489641.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>506074.500000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>540803.000000</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-348e8786-5efe-4cde-830e-5f45b6617973')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-348e8786-5efe-4cde-830e-5f45b6617973 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-348e8786-5efe-4cde-830e-5f45b6617973');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-d23c74de-de1d-497c-a664-e59602b71629">
      <button class="colab-df-quickchart" onclick="quickchart('df-d23c74de-de1d-497c-a664-e59602b71629')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-d23c74de-de1d-497c-a664-e59602b71629 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:492}"
id="rGa1C12XqvG6" data-outputId="a662533a-11f6-4862-a5f2-36c443232466">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>CRZ_street_group <span class="op">=</span> CRZ_df.groupby(<span class="st">&quot;Detection Group&quot;</span>)[<span class="st">&quot;CRZ Entries&quot;</span>]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#CRZ_street_group.describe()</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>CRZ_street_group.unique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="12">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CRZ Entries</th>
    </tr>
    <tr>
      <th>Detection Group</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Brooklyn Bridge</th>
      <td>[0, 123, 111, 133, 1, 95, 112, 98, 138, 102, 1...</td>
    </tr>
    <tr>
      <th>East 60th St</th>
      <td>[352, 3, 5, 0, 6, 157, 364, 9, 4, 189, 401, 7,...</td>
    </tr>
    <tr>
      <th>FDR Drive at 60th St</th>
      <td>[271, 0, 1, 195, 255, 2, 200, 3, 188, 196, 194...</td>
    </tr>
    <tr>
      <th>Holland Tunnel</th>
      <td>[110, 0, 1, 140, 132, 3, 137, 108, 139, 122, 1...</td>
    </tr>
    <tr>
      <th>Hugh L. Carey Tunnel</th>
      <td>[41, 0, 1, 58, 54, 40, 3, 37, 2, 38, 62, 60, 4...</td>
    </tr>
    <tr>
      <th>Lincoln Tunnel</th>
      <td>[66, 0, 2, 8, 135, 80, 1, 3, 5, 128, 72, 159, ...</td>
    </tr>
    <tr>
      <th>Manhattan Bridge</th>
      <td>[123, 0, 1, 2, 77, 107, 86, 121, 3, 71, 125, 4...</td>
    </tr>
    <tr>
      <th>Queens Midtown Tunnel</th>
      <td>[119, 0, 1, 86, 128, 2, 101, 114, 3, 99, 133, ...</td>
    </tr>
    <tr>
      <th>Queensboro Bridge</th>
      <td>[83, 0, 2, 1, 69, 76, 93, 3, 102, 72, 81, 95, ...</td>
    </tr>
    <tr>
      <th>West 60th St</th>
      <td>[201, 3, 6, 0, 1, 66, 204, 10, 72, 237, 4, 62,...</td>
    </tr>
    <tr>
      <th>West Side Highway at 60th St</th>
      <td>[138, 0, 160, 101, 123, 100, 142, 103, 3, 154,...</td>
    </tr>
    <tr>
      <th>Williamsburg Bridge</th>
      <td>[172, 1, 0, 127, 184, 137, 198, 2, 142, 176, 1...</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> object</label>
</div>
</div>
<div class="cell markdown" id="78jLgaPaeWoL">
<p>This is filtering of the total traffic dataset for data only within
the current congestion relief zone. This is for future comparison to
show how traffic within the CRZ has changed over time.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:826}"
id="5jRgkza6dmFE" data-outputId="55d7e8e1-7322-4aa3-ae74-bd22553ad211">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define keywords for streets at or below 60th Street</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>keywords <span class="op">=</span> [<span class="ss">f&quot;</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> ST&quot;</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">61</span>)] <span class="op">+</span> [</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;HOUSTON&quot;</span>, <span class="st">&quot;CANAL&quot;</span>, <span class="st">&quot;CHAMBERS&quot;</span>, <span class="st">&quot;WALL&quot;</span>, <span class="st">&quot;BROAD&quot;</span>, <span class="st">&quot;FULTON&quot;</span>, <span class="st">&quot;VESSEY&quot;</span>, <span class="st">&quot;PARK PLACE&quot;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter based on &#39;From&#39; or &#39;To&#39; containing those keywords</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_below_60th(row):</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    from_str <span class="op">=</span> <span class="bu">str</span>(row[<span class="st">&#39;From&#39;</span>]).upper()</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    to_str <span class="op">=</span> <span class="bu">str</span>(row[<span class="st">&#39;To&#39;</span>]).upper()</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">any</span>(k <span class="kw">in</span> from_str <span class="kw">or</span> k <span class="kw">in</span> to_str <span class="cf">for</span> k <span class="kw">in</span> keywords)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>traffic_below_60 <span class="op">=</span> traffic_df[traffic_df.<span class="bu">apply</span>(is_below_60th, axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>traffic_below_60</span></code></pre></div>
<div class="output execute_result" data-execution_count="13">

  <div id="df-0e06f000-bbff-41f4-a2f2-2efa6837a961" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>SegmentID</th>
      <th>Roadway Name</th>
      <th>From</th>
      <th>To</th>
      <th>Direction</th>
      <th>Date</th>
      <th>12:00-1:00 AM</th>
      <th>1:00-2:00AM</th>
      <th>2:00-3:00AM</th>
      <th>...</th>
      <th>2:00-3:00PM</th>
      <th>3:00-4:00PM</th>
      <th>4:00-5:00PM</th>
      <th>5:00-6:00PM</th>
      <th>6:00-7:00PM</th>
      <th>7:00-8:00PM</th>
      <th>8:00-9:00PM</th>
      <th>9:00-10:00PM</th>
      <th>10:00-11:00PM</th>
      <th>11:00-12:00AM</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>180</th>
      <td>180</td>
      <td>34858</td>
      <td>KENT AVENUE</td>
      <td>NORTH 1 STREET</td>
      <td>GRAND STREET</td>
      <td>NB</td>
      <td>01/09/2012</td>
      <td>97.0</td>
      <td>66.0</td>
      <td>54.0</td>
      <td>...</td>
      <td>269.0</td>
      <td>365.0</td>
      <td>379.0</td>
      <td>399.0</td>
      <td>354.0</td>
      <td>287.0</td>
      <td>216.0</td>
      <td>178.0</td>
      <td>141.0</td>
      <td>129.0</td>
    </tr>
    <tr>
      <th>181</th>
      <td>181</td>
      <td>34858</td>
      <td>KENT AVENUE</td>
      <td>NORTH 1 STREET</td>
      <td>GRAND STREET</td>
      <td>NB</td>
      <td>01/10/2012</td>
      <td>114.0</td>
      <td>66.0</td>
      <td>46.0</td>
      <td>...</td>
      <td>274.0</td>
      <td>347.0</td>
      <td>400.0</td>
      <td>351.0</td>
      <td>329.0</td>
      <td>296.0</td>
      <td>223.0</td>
      <td>189.0</td>
      <td>168.0</td>
      <td>160.0</td>
    </tr>
    <tr>
      <th>182</th>
      <td>182</td>
      <td>34858</td>
      <td>KENT AVENUE</td>
      <td>NORTH 1 STREET</td>
      <td>GRAND STREET</td>
      <td>NB</td>
      <td>01/11/2012</td>
      <td>139.0</td>
      <td>86.0</td>
      <td>64.0</td>
      <td>...</td>
      <td>340.0</td>
      <td>393.0</td>
      <td>379.0</td>
      <td>392.0</td>
      <td>358.0</td>
      <td>298.0</td>
      <td>233.0</td>
      <td>207.0</td>
      <td>168.0</td>
      <td>144.0</td>
    </tr>
    <tr>
      <th>183</th>
      <td>183</td>
      <td>34858</td>
      <td>KENT AVENUE</td>
      <td>NORTH 1 STREET</td>
      <td>GRAND STREET</td>
      <td>NB</td>
      <td>01/12/2012</td>
      <td>135.0</td>
      <td>139.0</td>
      <td>89.0</td>
      <td>...</td>
      <td>239.0</td>
      <td>370.0</td>
      <td>407.0</td>
      <td>446.0</td>
      <td>406.0</td>
      <td>301.0</td>
      <td>250.0</td>
      <td>234.0</td>
      <td>185.0</td>
      <td>180.0</td>
    </tr>
    <tr>
      <th>184</th>
      <td>184</td>
      <td>34858</td>
      <td>KENT AVENUE</td>
      <td>NORTH 1 STREET</td>
      <td>GRAND STREET</td>
      <td>NB</td>
      <td>01/13/2012</td>
      <td>149.0</td>
      <td>145.0</td>
      <td>80.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>42337</th>
      <td>347</td>
      <td>34013</td>
      <td>WEST 30th STREET</td>
      <td>5th Avenue</td>
      <td>Broadway</td>
      <td>EB</td>
      <td>11/18/2020</td>
      <td>37.0</td>
      <td>25.0</td>
      <td>23.0</td>
      <td>...</td>
      <td>343.0</td>
      <td>282.0</td>
      <td>374.0</td>
      <td>322.0</td>
      <td>338.0</td>
      <td>268.0</td>
      <td>180.0</td>
      <td>190.0</td>
      <td>133.0</td>
      <td>71.0</td>
    </tr>
    <tr>
      <th>42338</th>
      <td>347</td>
      <td>34013</td>
      <td>WEST 30th STREET</td>
      <td>5th Avenue</td>
      <td>Broadway</td>
      <td>EB</td>
      <td>11/19/2020</td>
      <td>46.0</td>
      <td>37.0</td>
      <td>14.0</td>
      <td>...</td>
      <td>300.0</td>
      <td>357.0</td>
      <td>330.0</td>
      <td>375.0</td>
      <td>469.0</td>
      <td>304.0</td>
      <td>246.0</td>
      <td>195.0</td>
      <td>150.0</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>42339</th>
      <td>347</td>
      <td>34013</td>
      <td>WEST 30th STREET</td>
      <td>5th Avenue</td>
      <td>Broadway</td>
      <td>EB</td>
      <td>11/20/2020</td>
      <td>53.0</td>
      <td>18.0</td>
      <td>21.0</td>
      <td>...</td>
      <td>365.0</td>
      <td>371.0</td>
      <td>553.0</td>
      <td>537.0</td>
      <td>568.0</td>
      <td>525.0</td>
      <td>373.0</td>
      <td>329.0</td>
      <td>231.0</td>
      <td>95.0</td>
    </tr>
    <tr>
      <th>42340</th>
      <td>347</td>
      <td>34013</td>
      <td>WEST 30th STREET</td>
      <td>5th Avenue</td>
      <td>Broadway</td>
      <td>EB</td>
      <td>11/21/2020</td>
      <td>76.0</td>
      <td>57.0</td>
      <td>28.0</td>
      <td>...</td>
      <td>643.0</td>
      <td>609.0</td>
      <td>686.0</td>
      <td>645.0</td>
      <td>614.0</td>
      <td>505.0</td>
      <td>400.0</td>
      <td>307.0</td>
      <td>230.0</td>
      <td>122.0</td>
    </tr>
    <tr>
      <th>42341</th>
      <td>347</td>
      <td>34013</td>
      <td>WEST 30th STREET</td>
      <td>5th Avenue</td>
      <td>Broadway</td>
      <td>EB</td>
      <td>11/22/2020</td>
      <td>78.0</td>
      <td>48.0</td>
      <td>29.0</td>
      <td>...</td>
      <td>635.0</td>
      <td>677.0</td>
      <td>597.0</td>
      <td>572.0</td>
      <td>483.0</td>
      <td>443.0</td>
      <td>236.0</td>
      <td>163.0</td>
      <td>130.0</td>
      <td>74.0</td>
    </tr>
  </tbody>
</table>
<p>13909 rows Ã— 31 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0e06f000-bbff-41f4-a2f2-2efa6837a961')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0e06f000-bbff-41f4-a2f2-2efa6837a961 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0e06f000-bbff-41f4-a2f2-2efa6837a961');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-cf3536d0-fa2c-4488-9db6-1a88f958bc18">
      <button class="colab-df-quickchart" onclick="quickchart('df-cf3536d0-fa2c-4488-9db6-1a88f958bc18')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-cf3536d0-fa2c-4488-9db6-1a88f958bc18 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_c35acb6b-50c0-4fea-9b39-57442e93aed6">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('traffic_below_60')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_c35acb6b-50c0-4fea-9b39-57442e93aed6 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('traffic_below_60');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="zT1KjAQNe02m">
<p>This is filtering of the total traffic dataset to exclude any roads
outside of manhattan. This is for later comparison to show how traffic
of manhattan in general has changed over time. This may be scrapped
later as the majority of traffic flow is below 60th street anyways and
is what we are primarily concerned with, but we'll keep it for now.</p>
</div>
<div class="cell code" id="qMUsGlhdrip3">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude segments with known non-Manhattan indicators in their roadway names</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>non_manhattan_keywords <span class="op">=</span> [<span class="st">&#39;HYLAN&#39;</span>, <span class="st">&#39;RICHMOND&#39;</span>, <span class="st">&#39;STATEN&#39;</span>, <span class="st">&#39;BROOKLYN&#39;</span>, <span class="st">&#39;CLOVE&#39;</span>, <span class="st">&#39;BAY ST&#39;</span>, <span class="st">&#39;NARROWS&#39;</span>, <span class="st">&#39;OCEAN TERRACE&#39;</span>]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_likely_manhattan(row):</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    roadway <span class="op">=</span> <span class="bu">str</span>(row[<span class="st">&#39;Roadway Name&#39;</span>]).upper()</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">not</span> <span class="bu">any</span>(b <span class="kw">in</span> roadway <span class="cf">for</span> b <span class="kw">in</span> non_manhattan_keywords)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>traffic_manhattan <span class="op">=</span> traffic_df[traffic_df.<span class="bu">apply</span>(is_likely_manhattan, axis<span class="op">=</span><span class="dv">1</span>)]</span></code></pre></div>
</div>
<div class="cell markdown" id="IEisZBc1fLhI">
<p>This is important and specific filtering. The post-CRZ dataset only
counts traffic at a few entry points, much less than the total traffic
dataset. Therefore we have to cutdown the total traffic dataset to align
the data better and show a clearer picture of the successs of the CRZ.
This is finding all the observations of the total traffic dataset that
have similar locations to the CRZ ones.</p>
</div>
<div class="cell code" id="2gT688EQyO8w">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define entry point-related keywords to identify relevant segments</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>entry_point_keywords <span class="op">=</span> {</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Brooklyn Bridge&#39;</span>: [<span class="st">&#39;BROOKLYN BRIDGE&#39;</span>, <span class="st">&#39;PARK ROW&#39;</span>, <span class="st">&#39;CENTRE ST&#39;</span>, <span class="st">&#39;CITY HALL&#39;</span>, <span class="st">&#39;FRANKFORT ST&#39;</span>],</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;East 60th St&#39;</span>: [<span class="st">&#39;E 60&#39;</span>, <span class="st">&#39;EAST 60&#39;</span>],</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;FDR Drive at 60th St&#39;</span>: [<span class="st">&#39;FDR&#39;</span>, <span class="st">&#39;FDR DRIVE&#39;</span>, <span class="st">&#39;FDR DR&#39;</span>],</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Holland Tunnel&#39;</span>: [<span class="st">&#39;HOLLAND TUNNEL&#39;</span>, <span class="st">&#39;CANAL ST&#39;</span>, <span class="st">&#39;VARICK ST&#39;</span>],</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Hugh L. Carey Tunnel&#39;</span>: [<span class="st">&#39;CAREY TUNNEL&#39;</span>, <span class="st">&#39;BATTERY TUNNEL&#39;</span>, <span class="st">&#39;HUGH L&#39;</span>, <span class="st">&#39;I-478&#39;</span>, <span class="st">&#39;TRINITY PL&#39;</span>],</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Lincoln Tunnel&#39;</span>: [<span class="st">&#39;LINCOLN TUNNEL&#39;</span>, <span class="st">&#39;DYER AVE&#39;</span>, <span class="st">&#39;W 39 ST&#39;</span>, <span class="st">&#39;LINCOLN&#39;</span>],</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Manhattan Bridge&#39;</span>: [<span class="st">&#39;MANHATTAN BRIDGE&#39;</span>, <span class="st">&#39;CANAL ST&#39;</span>, <span class="st">&#39;BOWERY&#39;</span>],</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Queens Midtown Tunnel&#39;</span>: [<span class="st">&#39;MIDTOWN TUNNEL&#39;</span>, <span class="st">&#39;QUEENS MIDTOWN&#39;</span>, <span class="st">&#39;TUNNEL ENTRANCE&#39;</span>, <span class="st">&#39;34TH ST&#39;</span>, <span class="st">&#39;2 AVE&#39;</span>],</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Queensboro Bridge&#39;</span>: [<span class="st">&#39;QUEENSBORO&#39;</span>, <span class="st">&#39;59 ST BRIDGE&#39;</span>, <span class="st">&#39;QUEENS PLAZA&#39;</span>, <span class="st">&#39;E 59 ST&#39;</span>],</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;West 60th St&#39;</span>: [<span class="st">&#39;W 60&#39;</span>, <span class="st">&#39;WEST 60&#39;</span>, <span class="st">&#39;60TH ST&#39;</span>],</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;West Side Highway at 60th St&#39;</span>: [<span class="st">&#39;WEST SIDE HWY&#39;</span>, <span class="st">&#39;WEST SIDE HIGHWAY&#39;</span>, <span class="st">&#39;RTE 9A&#39;</span>, <span class="st">&#39;12TH AVE&#39;</span>, <span class="st">&#39;HENRY HUDSON&#39;</span>],</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Williamsburg Bridge&#39;</span>: [<span class="st">&#39;WILLIAMSBURG BRIDGE&#39;</span>, <span class="st">&#39;DELANCEY ST&#39;</span>, <span class="st">&#39;CLINTON ST&#39;</span>]</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> matches_entry_point(row):</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>row[<span class="st">&#39;Roadway Name&#39;</span>]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>row[<span class="st">&#39;From&#39;</span>]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>row[<span class="st">&#39;To&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>.upper()</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">any</span>(<span class="bu">any</span>(kw <span class="kw">in</span> text <span class="cf">for</span> kw <span class="kw">in</span> kws) <span class="cf">for</span> kws <span class="kw">in</span> entry_point_keywords.values())</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter your full traffic_df to get only rows related to CRZ entry points</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>traffic_entry_points <span class="op">=</span> traffic_df[traffic_df.<span class="bu">apply</span>(matches_entry_point, axis<span class="op">=</span><span class="dv">1</span>)].copy()</span></code></pre></div>
</div>
<div class="cell markdown" id="dn8dyt7ufmTZ">
<p>This is concatenating the datasets now that they have the same
location data and combining them into a new dataset containing only
essential columns like the count, date, day of the week, location, and
original dataset.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:424}"
id="VEgZ2Knsyjx-" data-outputId="f7a5e8a2-465a-4350-94f7-d21bab8383bb">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> identify_entry_point(row):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>row[<span class="st">&#39;Roadway Name&#39;</span>]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>row[<span class="st">&#39;From&#39;</span>]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>row[<span class="st">&#39;To&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>.upper()</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> label, keywords <span class="kw">in</span> entry_point_keywords.items():</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">any</span>(kw <span class="kw">in</span> text <span class="cf">for</span> kw <span class="kw">in</span> keywords):</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> label</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean traffic entry data</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>traffic_entry_points[<span class="st">&#39;Location&#39;</span>] <span class="op">=</span> traffic_entry_points.<span class="bu">apply</span>(identify_entry_point, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>traffic_entry_points <span class="op">=</span> traffic_entry_points.dropna(subset<span class="op">=</span>[<span class="st">&#39;Location&#39;</span>])</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>time_cols <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> traffic_entry_points.columns <span class="cf">if</span> <span class="st">&#39;:&#39;</span> <span class="kw">in</span> col <span class="kw">or</span> <span class="st">&#39;AM&#39;</span> <span class="kw">in</span> col <span class="kw">or</span> <span class="st">&#39;PM&#39;</span> <span class="kw">in</span> col]</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>traffic_entry_points[<span class="st">&#39;Count&#39;</span>] <span class="op">=</span> traffic_entry_points[time_cols].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>, skipna<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>traffic_entry_points[<span class="st">&#39;Date&#39;</span>] <span class="op">=</span> pd.to_datetime(traffic_entry_points[<span class="st">&#39;Date&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>traffic_entry_points[<span class="st">&#39;Day of Week&#39;</span>] <span class="op">=</span> traffic_entry_points[<span class="st">&#39;Date&#39;</span>].dt.day_name()</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>traffic_entry_points[<span class="st">&#39;Date&#39;</span>] <span class="op">=</span> traffic_entry_points[<span class="st">&#39;Date&#39;</span>].dt.strftime(<span class="st">&#39;%m/</span><span class="sc">%d</span><span class="st">/%Y&#39;</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>traffic_entry_points[<span class="st">&#39;Source&#39;</span>] <span class="op">=</span> <span class="st">&#39;Traffic Entry Points&#39;</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>traffic_final_clean <span class="op">=</span> traffic_entry_points[[<span class="st">&#39;Date&#39;</span>, <span class="st">&#39;Location&#39;</span>, <span class="st">&#39;Day of Week&#39;</span>, <span class="st">&#39;Count&#39;</span>, <span class="st">&#39;Source&#39;</span>]]</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean CRZ_df</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>CRZ_df <span class="op">=</span> CRZ_df.copy()</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>crz_clean <span class="op">=</span> CRZ_df[[<span class="st">&#39;Toll Date&#39;</span>, <span class="st">&#39;Detection Group&#39;</span>, <span class="st">&#39;Day of Week&#39;</span>, <span class="st">&#39;CRZ Entries&#39;</span>]].copy()</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>crz_clean.columns <span class="op">=</span> [<span class="st">&#39;Date&#39;</span>, <span class="st">&#39;Location&#39;</span>, <span class="st">&#39;Day of Week&#39;</span>, <span class="st">&#39;Count&#39;</span>]</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>crz_clean[<span class="st">&#39;Source&#39;</span>] <span class="op">=</span> <span class="st">&#39;CRZ Dataset&#39;</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>combined_crz_traffic_filtered <span class="op">=</span> pd.concat([traffic_final_clean, crz_clean], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>combined_crz_traffic_filtered</span></code></pre></div>
<div class="output execute_result" data-execution_count="16">

  <div id="df-49748d42-92d0-43f5-8897-8853772e608d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Location</th>
      <th>Day of Week</th>
      <th>Count</th>
      <th>Source</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>01/09/2012</td>
      <td>Williamsburg Bridge</td>
      <td>Monday</td>
      <td>6022.0</td>
      <td>Traffic Entry Points</td>
    </tr>
    <tr>
      <th>1</th>
      <td>01/10/2012</td>
      <td>Williamsburg Bridge</td>
      <td>Tuesday</td>
      <td>6130.0</td>
      <td>Traffic Entry Points</td>
    </tr>
    <tr>
      <th>2</th>
      <td>01/11/2012</td>
      <td>Williamsburg Bridge</td>
      <td>Wednesday</td>
      <td>6179.0</td>
      <td>Traffic Entry Points</td>
    </tr>
    <tr>
      <th>3</th>
      <td>01/12/2012</td>
      <td>Williamsburg Bridge</td>
      <td>Thursday</td>
      <td>6198.0</td>
      <td>Traffic Entry Points</td>
    </tr>
    <tr>
      <th>4</th>
      <td>01/13/2012</td>
      <td>Williamsburg Bridge</td>
      <td>Friday</td>
      <td>6591.0</td>
      <td>Traffic Entry Points</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>583155</th>
      <td>01/05/2025</td>
      <td>Manhattan Bridge</td>
      <td>Sunday</td>
      <td>85.0</td>
      <td>CRZ Dataset</td>
    </tr>
    <tr>
      <th>583156</th>
      <td>01/05/2025</td>
      <td>Williamsburg Bridge</td>
      <td>Sunday</td>
      <td>150.0</td>
      <td>CRZ Dataset</td>
    </tr>
    <tr>
      <th>583157</th>
      <td>01/05/2025</td>
      <td>East 60th St</td>
      <td>Sunday</td>
      <td>320.0</td>
      <td>CRZ Dataset</td>
    </tr>
    <tr>
      <th>583158</th>
      <td>01/05/2025</td>
      <td>FDR Drive at 60th St</td>
      <td>Sunday</td>
      <td>142.0</td>
      <td>CRZ Dataset</td>
    </tr>
    <tr>
      <th>583159</th>
      <td>01/05/2025</td>
      <td>Holland Tunnel</td>
      <td>Sunday</td>
      <td>85.0</td>
      <td>CRZ Dataset</td>
    </tr>
  </tbody>
</table>
<p>583160 rows Ã— 5 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-49748d42-92d0-43f5-8897-8853772e608d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-49748d42-92d0-43f5-8897-8853772e608d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-49748d42-92d0-43f5-8897-8853772e608d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-25f141ae-aaac-4062-a6c3-e1b477b08482">
      <button class="colab-df-quickchart" onclick="quickchart('df-25f141ae-aaac-4062-a6c3-e1b477b08482')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-25f141ae-aaac-4062-a6c3-e1b477b08482 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_e0acb77f-798b-4bde-b80d-6521eace88fd">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('combined_crz_traffic_filtered')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_e0acb77f-798b-4bde-b80d-6521eace88fd button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('combined_crz_traffic_filtered');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="hQI_tFnVgFFV">
<p>We are now beginning to visualize the new dataframe. This is a
histogram showing the number of vehicles at each entry location with
each dataset side by side to represent a before and after effect of the
CRZ. FDR Drive at 60th, Queens midtown tunnel, and west side highway at
60th street have seen massive reductions in traffic volume.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:607}"
id="_tretoQg2tzg" data-outputId="653c3651-87fc-480d-a750-3d90bb281eaa">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure Count is numeric</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>] <span class="op">=</span> pd.to_numeric(combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove missing or zero counts</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>filtered_plot_df <span class="op">=</span> combined_crz_traffic_filtered[</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>].notna() <span class="op">&amp;</span> (combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>].copy()</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Group and scale count</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>hist_data <span class="op">=</span> filtered_plot_df.groupby([<span class="st">&#39;Location&#39;</span>, <span class="st">&#39;Source&#39;</span>])[<span class="st">&#39;Count&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>hist_data[<span class="st">&#39;Count&#39;</span>] <span class="op">=</span> hist_data[<span class="st">&#39;Count&#39;</span>] <span class="op">/</span> <span class="dv">100_000</span>  <span class="co"># scale to hundreds of thousands</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Reverse hue order: Pre-CRZ (left), Post-CRZ (right)</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>sns.barplot(</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>hist_data,</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">&#39;Location&#39;</span>,</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">&#39;Count&#39;</span>,</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span><span class="st">&#39;Source&#39;</span>,</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    hue_order<span class="op">=</span>[<span class="st">&#39;Traffic Entry Points&#39;</span>, <span class="st">&#39;CRZ Dataset&#39;</span>]  <span class="co"># reverse the hue order</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Total Traffic Count by Entry Point (in Hundreds of Thousands)&#39;</span>)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Entry Point Location&#39;</span>)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Count (x100,000 vehicles)&#39;</span>)</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">&#39;right&#39;</span>)</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_4d12ce75fe99437cb0cb3ffc5455800b/8b6e0e05614055551691a496d7372d66fc3864b7.png" /></p>
</div>
</div>
<div class="cell markdown" id="yEKHSLAcheg-">
<p>This is basically the same plot as before but shows the data as a
percentage of total traffic volume rather than raw amount. The
distribution of traffic is easier to see and it's more apparent the
change to each entrance.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:606}"
id="8H0kby25LBeK" data-outputId="fa6d2c42-0031-467f-ec80-2c6644e1e11f">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure &#39;Count&#39; is numeric</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>] <span class="op">=</span> pd.to_numeric(combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter valid rows</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>filtered_plot_df <span class="op">=</span> combined_crz_traffic_filtered[</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>].notna() <span class="op">&amp;</span> (combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>].copy()</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by Location and Source</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>hist_data <span class="op">=</span> filtered_plot_df.groupby([<span class="st">&#39;Location&#39;</span>, <span class="st">&#39;Source&#39;</span>])[<span class="st">&#39;Count&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute percentage of total traffic per source (pre/post CRZ)</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>hist_data[<span class="st">&#39;Percent&#39;</span>] <span class="op">=</span> hist_data[<span class="st">&#39;Count&#39;</span>] <span class="op">/</span> hist_data.groupby(<span class="st">&#39;Source&#39;</span>)[<span class="st">&#39;Count&#39;</span>].transform(<span class="st">&#39;sum&#39;</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with reversed hue order</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>sns.barplot(</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>hist_data,</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">&#39;Location&#39;</span>,</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">&#39;Percent&#39;</span>,</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span><span class="st">&#39;Source&#39;</span>,</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    hue_order<span class="op">=</span>[<span class="st">&#39;Traffic Entry Points&#39;</span>, <span class="st">&#39;CRZ Dataset&#39;</span>]  <span class="co"># reversed order</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Share of Total Traffic by Entry Point (as Percentage of Each Dataset)&#39;</span>)</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Entry Point Location&#39;</span>)</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Percent of Total Traffic (%)&#39;</span>)</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">&#39;right&#39;</span>)</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_4d12ce75fe99437cb0cb3ffc5455800b/bb8d3993408753991029b9ac737ee8bf8e160725.png" /></p>
</div>
</div>
<div class="cell markdown" id="intLSdzw1Poo">
<p>note for later: heatmap/density map of manhattan</p>
</div>
<div class="cell markdown" id="cKup1GFrigz1">
<p>This is a scaled line chart which shows the total traffic volume over
time(locations not specified) so the spikes are easier to see. There was
a big spike in 2014 and a few more spikes after that, possibly the
result of major construction projects in the area. The post-CRZ data
shows a trend of traffic increasing during the week, and dipping on the
weekends since people don't go out as much.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:447}"
id="qdla17QZ3iFX" data-outputId="a1e04c41-e7a9-4159-a2ee-881fca0dfdde">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure date and count are clean</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>combined_crz_traffic_filtered[<span class="st">&#39;Date&#39;</span>] <span class="op">=</span> pd.to_datetime(combined_crz_traffic_filtered[<span class="st">&#39;Date&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>] <span class="op">=</span> pd.to_numeric(combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for clean data</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>plot_df <span class="op">=</span> combined_crz_traffic_filtered[</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>].notna() <span class="op">&amp;</span> (combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>].copy()</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by date and source (daily aggregation)</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>plot_df <span class="op">=</span> plot_df.groupby([<span class="st">&#39;Date&#39;</span>, <span class="st">&#39;Source&#39;</span>])[<span class="st">&#39;Count&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate into two datasets</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>pre_crz_df <span class="op">=</span> plot_df[plot_df[<span class="st">&#39;Source&#39;</span>] <span class="op">==</span> <span class="st">&#39;Traffic Entry Points&#39;</span>]</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>post_crz_df <span class="op">=</span> plot_df[plot_df[<span class="st">&#39;Source&#39;</span>] <span class="op">==</span> <span class="st">&#39;CRZ Dataset&#39;</span>]</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">5</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Line chart for pre-CRZ</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(pre_crz_df[<span class="st">&#39;Date&#39;</span>], pre_crz_df[<span class="st">&#39;Count&#39;</span>], label<span class="op">=</span><span class="st">&#39;Pre-CRZ&#39;</span>, color<span class="op">=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">&#39;Traffic Entry Points (Pre-CRZ)&#39;</span>)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">&#39;Date&#39;</span>)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">&#39;Total Count&#39;</span>)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Line chart for post-CRZ</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(post_crz_df[<span class="st">&#39;Date&#39;</span>], post_crz_df[<span class="st">&#39;Count&#39;</span>], label<span class="op">=</span><span class="st">&#39;Post-CRZ&#39;</span>, color<span class="op">=</span><span class="st">&#39;green&#39;</span>)</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">&#39;CRZ Dataset (Post-CRZ)&#39;</span>)</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">&#39;Date&#39;</span>)</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_4d12ce75fe99437cb0cb3ffc5455800b/7d7d62e13fec67ca3244e5dc5476cac4bdc7bd40.png" /></p>
</div>
</div>
<div class="cell markdown" id="FRLnl_enjRMT">
<p>This is the same chart but again as a percentage of total volume.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:217}"
id="PHMB3kH9PBlh" data-outputId="7d86034e-6051-4726-f71d-5119bd493b45">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_4d12ce75fe99437cb0cb3ffc5455800b/a92f43df2c4d48ab6af1139a034600258efa3486.png" /></p>
</div>
</div>
<div class="cell markdown" id="zFEGEGE8j6uC">
<p>This is the same histogram as before but they're separate instead of
together. The point is to show the traffic trends individually within
each time period and together to give a "before and after" effect.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:534}"
id="KYgCALU84RnX" data-outputId="f93a9c84-d6f1-48b1-e828-8e2f6f964c7b">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure data is clean</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>] <span class="op">=</span> pd.to_numeric(combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>combined_crz_traffic_filtered <span class="op">=</span> combined_crz_traffic_filtered[</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>].notna() <span class="op">&amp;</span> (combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>].copy()</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Split datasets</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>pre_crz_df <span class="op">=</span> combined_crz_traffic_filtered[combined_crz_traffic_filtered[<span class="st">&#39;Source&#39;</span>] <span class="op">==</span> <span class="st">&#39;Traffic Entry Points&#39;</span>]</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>post_crz_df <span class="op">=</span> combined_crz_traffic_filtered[combined_crz_traffic_filtered[<span class="st">&#39;Source&#39;</span>] <span class="op">==</span> <span class="st">&#39;CRZ Dataset&#39;</span>]</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate by location</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>pre_crz_counts <span class="op">=</span> pre_crz_df.groupby(<span class="st">&#39;Location&#39;</span>)[<span class="st">&#39;Count&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>post_crz_counts <span class="op">=</span> post_crz_df.groupby(<span class="st">&#39;Location&#39;</span>)[<span class="st">&#39;Count&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot side-by-side histograms</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">6</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-CRZ histogram</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>pre_crz_counts, x<span class="op">=</span><span class="st">&#39;Location&#39;</span>, y<span class="op">=</span><span class="st">&#39;Count&#39;</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>], color<span class="op">=</span><span class="st">&#39;skyblue&#39;</span>)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">&#39;Pre-CRZ (Traffic Entry Points)&#39;</span>)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">&#39;Total Count&#39;</span>)</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">&#39;Entry Point&#39;</span>)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Post-CRZ histogram</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>post_crz_counts, x<span class="op">=</span><span class="st">&#39;Location&#39;</span>, y<span class="op">=</span><span class="st">&#39;Count&#39;</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>], color<span class="op">=</span><span class="st">&#39;lightgreen&#39;</span>)</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">&#39;Post-CRZ (CRZ Dataset)&#39;</span>)</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">&#39;&#39;</span>)  <span class="co"># shared y-axis</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">&#39;Entry Point&#39;</span>)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_4d12ce75fe99437cb0cb3ffc5455800b/c0b2b5943cdcc40094bb4c719684957a497aa33f.png" /></p>
</div>
</div>
<div class="cell markdown" id="gDHUNPWNkK3D">
<p>Pie chart showing the distribution of traffic across the entry points
for each time period.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:509}"
id="wd5TkEzBPhRQ" data-outputId="950c32d7-a571-401e-c181-c66496ce1a4b">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure numeric count</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>] <span class="op">=</span> pd.to_numeric(combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter clean rows</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>pie_df <span class="op">=</span> combined_crz_traffic_filtered[</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>].notna() <span class="op">&amp;</span> (combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>].copy()</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by Location and Source</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>pie_data <span class="op">=</span> pie_df.groupby([<span class="st">&#39;Location&#39;</span>, <span class="st">&#39;Source&#39;</span>])[<span class="st">&#39;Count&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Split into the two datasets</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>pre_crz_data <span class="op">=</span> pie_data[pie_data[<span class="st">&#39;Source&#39;</span>] <span class="op">==</span> <span class="st">&#39;Traffic Entry Points&#39;</span>]</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>post_crz_data <span class="op">=</span> pie_data[pie_data[<span class="st">&#39;Source&#39;</span>] <span class="op">==</span> <span class="st">&#39;CRZ Dataset&#39;</span>]</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot two pie charts</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">7</span>))</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-CRZ pie</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].pie(pre_crz_data[<span class="st">&#39;Count&#39;</span>], labels<span class="op">=</span>pre_crz_data[<span class="st">&#39;Location&#39;</span>], autopct<span class="op">=</span><span class="st">&#39;</span><span class="sc">%1.1f%%</span><span class="st">&#39;</span>, startangle<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">&#39;Traffic Entry Points (Pre-CRZ)&#39;</span>)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Post-CRZ pie</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].pie(post_crz_data[<span class="st">&#39;Count&#39;</span>], labels<span class="op">=</span>post_crz_data[<span class="st">&#39;Location&#39;</span>], autopct<span class="op">=</span><span class="st">&#39;</span><span class="sc">%1.1f%%</span><span class="st">&#39;</span>, startangle<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">&#39;CRZ Dataset (Post-CRZ)&#39;</span>)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_4d12ce75fe99437cb0cb3ffc5455800b/5fad20078b41b2e7714612e750d8f390b7484c4e.png" /></p>
</div>
</div>
<div class="cell markdown" id="Sx7gtck3kZeg">
<p>The final chart that can help us understand the effect of the CRZ.
This is the total traffic over time, meshed between time periods. This
should show us if traffic volume has decreased since the CRZ was
implemented.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:607}"
id="XEIeYC5IQ3LC" data-outputId="b129fc75-6ff2-4ecb-a5b9-c9ade1fa261f">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure datetime and numeric values are clean</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>combined_crz_traffic_filtered[<span class="st">&#39;Date&#39;</span>] <span class="op">=</span> pd.to_datetime(combined_crz_traffic_filtered[<span class="st">&#39;Date&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>] <span class="op">=</span> pd.to_numeric(combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop bad data</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>volume_df <span class="op">=</span> combined_crz_traffic_filtered[</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>].notna() <span class="op">&amp;</span> (combined_crz_traffic_filtered[<span class="st">&#39;Count&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>].copy()</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Group to weekly totals</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>weekly_totals <span class="op">=</span> volume_df.groupby([<span class="st">&#39;Source&#39;</span>, pd.Grouper(key<span class="op">=</span><span class="st">&#39;Date&#39;</span>, freq<span class="op">=</span><span class="st">&#39;W&#39;</span>)])[<span class="st">&#39;Count&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply rolling average to smooth (window of 4 weeks)</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>weekly_totals[<span class="st">&#39;Smoothed&#39;</span>] <span class="op">=</span> weekly_totals.groupby(<span class="st">&#39;Source&#39;</span>)[<span class="st">&#39;Count&#39;</span>].transform(<span class="kw">lambda</span> x: x.rolling(window<span class="op">=</span><span class="dv">4</span>, min_periods<span class="op">=</span><span class="dv">1</span>).mean())</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign artificial index for visual continuity</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>pre_crz <span class="op">=</span> weekly_totals[weekly_totals[<span class="st">&#39;Source&#39;</span>] <span class="op">==</span> <span class="st">&#39;Traffic Entry Points&#39;</span>].copy()</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>post_crz <span class="op">=</span> weekly_totals[weekly_totals[<span class="st">&#39;Source&#39;</span>] <span class="op">==</span> <span class="st">&#39;CRZ Dataset&#39;</span>].copy()</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create artificial time axis</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>pre_crz[<span class="st">&#39;Week Index&#39;</span>] <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(pre_crz))</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>post_crz[<span class="st">&#39;Week Index&#39;</span>] <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(pre_crz), <span class="bu">len</span>(pre_crz) <span class="op">+</span> <span class="bu">len</span>(post_crz))</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>smoothed_plot_df <span class="op">=</span> pd.concat([pre_crz, post_crz])</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> label, group <span class="kw">in</span> smoothed_plot_df.groupby(<span class="st">&#39;Source&#39;</span>):</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    plt.plot(group[<span class="st">&#39;Week Index&#39;</span>], group[<span class="st">&#39;Smoothed&#39;</span>], label<span class="op">=</span>label)</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Smoothed Weekly Traffic Volume (Pre-CRZ vs Post-CRZ, Artificial Timeline)&#39;</span>)</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Artificial Time (Weeks)&#39;</span>)</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Smoothed Vehicle Count&#39;</span>)</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_4d12ce75fe99437cb0cb3ffc5455800b/37a3f29b0fd550476695262ed671b2cba094cf52.png" /></p>
</div>
</div>
<div class="cell markdown" id="6yVw5HNcq3Ri">
<p>Model ideas:</p>
<ul>
<li>A simple regression model to predict what the future traffic growth
will look like in the next year, month, or tomorrow. We can use overall
traffic growth over time, or traffic in a certain area. We can also
predict distribution over these areas.</li>
<li>We can calculate the amount of revenue the city is making from the
city based on the time the car entered and thus how much they were
charged. We can then predict when the city will turn a profit from this
project. It cost the city of New York approximately 507 million dollars.
We assign monetary values to each range of time, and multiply those
values by the amount of entries in that time range. We can then run a
regression over revenue over time and see where it crosses with the $507
million to get a date.</li>
</ul>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="VycCEZUBbxp4" data-outputId="d0f171dc-8bc0-433b-ab45-a57e6a0f0ee0">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a copy and parse datetime</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>CRZ_time_df <span class="op">=</span> CRZ_df.copy()</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>CRZ_time_df[<span class="st">&#39;Date&#39;</span>] <span class="op">=</span> pd.to_datetime(CRZ_time_df[<span class="st">&#39;Toll Date&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine if Peak or Overnight</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>CRZ_time_df[<span class="st">&#39;Period&#39;</span>] <span class="op">=</span> CRZ_time_df.<span class="bu">apply</span>(<span class="kw">lambda</span> row:</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Peak&#39;</span> <span class="cf">if</span> ((row[<span class="st">&#39;Date&#39;</span>].weekday() <span class="op">&lt;</span> <span class="dv">5</span> <span class="kw">and</span> <span class="dv">5</span> <span class="op">&lt;=</span> row[<span class="st">&#39;Date&#39;</span>].hour <span class="op">&lt;</span> <span class="dv">21</span>) <span class="kw">or</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>              (row[<span class="st">&#39;Date&#39;</span>].weekday() <span class="op">&gt;=</span> <span class="dv">5</span> <span class="kw">and</span> <span class="dv">9</span> <span class="op">&lt;=</span> row[<span class="st">&#39;Date&#39;</span>].hour <span class="op">&lt;</span> <span class="dv">21</span>))</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="st">&#39;Overnight&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract numeric class ID or TLC</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>CRZ_time_df[<span class="st">&#39;Class ID&#39;</span>] <span class="op">=</span> CRZ_time_df[<span class="st">&#39;Vehicle Class&#39;</span>].<span class="bu">apply</span>(</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> vc: <span class="st">&quot;TLC&quot;</span> <span class="cf">if</span> pd.notna(vc) <span class="kw">and</span> vc.startswith(<span class="st">&quot;TLC&quot;</span>) <span class="cf">else</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>              <span class="bu">int</span>(vc.split(<span class="st">&quot; &quot;</span>)[<span class="dv">0</span>]) <span class="cf">if</span> pd.notna(vc) <span class="kw">and</span> vc[<span class="dv">0</span>].isdigit() <span class="cf">else</span> <span class="va">None</span>)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign Toll Rate</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>tolls <span class="op">=</span> {</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: {<span class="st">&#39;Peak&#39;</span>: <span class="fl">9.00</span>, <span class="st">&#39;Overnight&#39;</span>: <span class="fl">2.25</span>},</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: {<span class="st">&#39;Peak&#39;</span>: <span class="fl">14.40</span>, <span class="st">&#39;Overnight&#39;</span>: <span class="fl">3.60</span>},</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: {<span class="st">&#39;Peak&#39;</span>: <span class="fl">21.60</span>, <span class="st">&#39;Overnight&#39;</span>: <span class="fl">5.40</span>},</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: {<span class="st">&#39;Peak&#39;</span>: <span class="fl">14.40</span>, <span class="st">&#39;Overnight&#39;</span>: <span class="fl">3.60</span>},</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>: {<span class="st">&#39;Peak&#39;</span>: <span class="fl">4.50</span>, <span class="st">&#39;Overnight&#39;</span>: <span class="fl">1.05</span>}</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>CRZ_time_df[<span class="st">&#39;Toll Rate&#39;</span>] <span class="op">=</span> CRZ_time_df.<span class="bu">apply</span>(</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> row: <span class="dv">0</span> <span class="cf">if</span> row[<span class="st">&#39;Class ID&#39;</span>] <span class="op">==</span> <span class="st">&quot;TLC&quot;</span> <span class="cf">else</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>               tolls.get(row[<span class="st">&#39;Class ID&#39;</span>], {}).get(row[<span class="st">&#39;Period&#39;</span>], <span class="dv">0</span>), axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Revenue</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>CRZ_time_df[<span class="st">&#39;CRZ Entries&#39;</span>] <span class="op">=</span> pd.to_numeric(CRZ_time_df[<span class="st">&#39;CRZ Entries&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>CRZ_time_df[<span class="st">&#39;Revenue&#39;</span>] <span class="op">=</span> CRZ_time_df[<span class="st">&#39;Toll Rate&#39;</span>] <span class="op">*</span> CRZ_time_df[<span class="st">&#39;CRZ Entries&#39;</span>]</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate daily data</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>daily_data <span class="op">=</span> CRZ_time_df.groupby(CRZ_time_df[<span class="st">&#39;Date&#39;</span>].dt.date).agg({</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;CRZ Entries&#39;</span>: <span class="st">&#39;sum&#39;</span>,</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Revenue&#39;</span>: <span class="st">&#39;sum&#39;</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>}).reset_index()</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>daily_data[<span class="st">&#39;Date&#39;</span>] <span class="op">=</span> pd.to_datetime(daily_data[<span class="st">&#39;Date&#39;</span>])</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Show results</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Daily Revenue Data:&quot;</span>)</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(daily_data.head())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Daily Revenue Data:
        Date  CRZ Entries    Revenue
0 2025-01-05       417981  607773.60
1 2025-01-06       437834  713039.25
2 2025-01-07       469961  756664.95
3 2025-01-08       480103  758992.80
4 2025-01-09       493076  763024.80
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="78"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:835}"
id="tXEaNAWQgTXP" data-outputId="0a4c63a1-3501-40ee-eab1-ceab9c335ad7">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsRegressor</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Create calendar-based features</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>daily_data[<span class="st">&#39;day_of_week&#39;</span>] <span class="op">=</span> daily_data[<span class="st">&#39;Date&#39;</span>].dt.dayofweek</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>daily_data[<span class="st">&#39;day_of_month&#39;</span>] <span class="op">=</span> daily_data[<span class="st">&#39;Date&#39;</span>].dt.day</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>daily_data[<span class="st">&#39;month&#39;</span>] <span class="op">=</span> daily_data[<span class="st">&#39;Date&#39;</span>].dt.month</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>daily_data[<span class="st">&#39;is_weekend&#39;</span>] <span class="op">=</span> daily_data[<span class="st">&#39;day_of_week&#39;</span>].isin([<span class="dv">5</span>, <span class="dv">6</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>daily_data[<span class="st">&#39;time_index&#39;</span>] <span class="op">=</span> (daily_data[<span class="st">&#39;Date&#39;</span>] <span class="op">-</span> daily_data[<span class="st">&#39;Date&#39;</span>].<span class="bu">min</span>()).dt.days</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Prepare features and target</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> [<span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;day_of_month&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;is_weekend&#39;</span>, <span class="st">&#39;time_index&#39;</span>, <span class="st">&#39;CRZ Entries&#39;</span>]</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> daily_data[features]</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> daily_data[<span class="st">&#39;Revenue&#39;</span>]</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale features</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Train KNN model with cross-validation</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>optimal_k <span class="op">=</span> <span class="bu">min</span>(<span class="dv">14</span>, <span class="bu">len</span>(X_scaled)<span class="op">-</span><span class="dv">1</span>)  <span class="co"># Adjust based on data size</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>knn <span class="op">=</span> KNeighborsRegressor(n_neighbors<span class="op">=</span>optimal_k, weights<span class="op">=</span><span class="st">&#39;distance&#39;</span>)</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>knn.fit(X_scaled, y)</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Generate future 90 days forecast</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>future_dates <span class="op">=</span> pd.date_range(start<span class="op">=</span>daily_data[<span class="st">&#39;Date&#39;</span>].<span class="bu">max</span>() <span class="op">+</span> pd.Timedelta(days<span class="op">=</span><span class="dv">1</span>), periods<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>future_df <span class="op">=</span> pd.DataFrame({<span class="st">&#39;Date&#39;</span>: future_dates})</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Create calendar features for future dates</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>future_df[<span class="st">&#39;day_of_week&#39;</span>] <span class="op">=</span> future_df[<span class="st">&#39;Date&#39;</span>].dt.dayofweek</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>future_df[<span class="st">&#39;day_of_month&#39;</span>] <span class="op">=</span> future_df[<span class="st">&#39;Date&#39;</span>].dt.day</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>future_df[<span class="st">&#39;month&#39;</span>] <span class="op">=</span> future_df[<span class="st">&#39;Date&#39;</span>].dt.month</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>future_df[<span class="st">&#39;is_weekend&#39;</span>] <span class="op">=</span> future_df[<span class="st">&#39;day_of_week&#39;</span>].isin([<span class="dv">5</span>, <span class="dv">6</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>future_df[<span class="st">&#39;time_index&#39;</span>] <span class="op">=</span> (future_df[<span class="st">&#39;Date&#39;</span>] <span class="op">-</span> daily_data[<span class="st">&#39;Date&#39;</span>].<span class="bu">min</span>()).dt.days</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate future traffic (using weekly patterns)</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>weekly_pattern <span class="op">=</span> daily_data.groupby(<span class="st">&#39;day_of_week&#39;</span>)[<span class="st">&#39;CRZ Entries&#39;</span>].mean()</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>future_df[<span class="st">&#39;CRZ Entries&#39;</span>] <span class="op">=</span> future_df[<span class="st">&#39;day_of_week&#39;</span>].<span class="bu">map</span>(weekly_pattern)</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare future features and scale</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>X_future <span class="op">=</span> future_df[features]</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>X_future_scaled <span class="op">=</span> scaler.transform(X_future)</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict future revenue</span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>future_df[<span class="st">&#39;Revenue&#39;</span>] <span class="op">=</span> knn.predict(X_future_scaled)</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Enhanced Visualization (without histogram)</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">10</span>))</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Historical vs Forecasted Revenue - Top Plot</span></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>plt.plot(daily_data[<span class="st">&#39;Date&#39;</span>], daily_data[<span class="st">&#39;Revenue&#39;</span>], <span class="st">&#39;b-&#39;</span>, label<span class="op">=</span><span class="st">&#39;Historical Revenue&#39;</span>)</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>plt.plot(future_df[<span class="st">&#39;Date&#39;</span>], future_df[<span class="st">&#39;Revenue&#39;</span>], <span class="st">&#39;r-&#39;</span>, label<span class="op">=</span><span class="st">&#39;Forecasted Revenue&#39;</span>)</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>plt.fill_between(future_df[<span class="st">&#39;Date&#39;</span>],</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>                 future_df[<span class="st">&#39;Revenue&#39;</span>] <span class="op">*</span> <span class="fl">0.9</span>,</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>                 future_df[<span class="st">&#39;Revenue&#39;</span>] <span class="op">*</span> <span class="fl">1.1</span>,</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>                 color<span class="op">=</span><span class="st">&#39;red&#39;</span>, alpha<span class="op">=</span><span class="fl">0.1</span>, label<span class="op">=</span><span class="st">&#39;Confidence Band&#39;</span>)</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;90-Day CRZ Revenue Forecast&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Revenue ($)&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Traffic-Revenue Relationship - Bottom Plot</span></span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>plt.scatter(daily_data[<span class="st">&#39;CRZ Entries&#39;</span>], daily_data[<span class="st">&#39;Revenue&#39;</span>], alpha<span class="op">=</span><span class="fl">0.6</span>, label<span class="op">=</span><span class="st">&#39;Historical&#39;</span>)</span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>plt.scatter(future_df[<span class="st">&#39;CRZ Entries&#39;</span>], future_df[<span class="st">&#39;Revenue&#39;</span>], color<span class="op">=</span><span class="st">&#39;red&#39;</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, label<span class="op">=</span><span class="st">&#39;Forecast&#39;</span>)</span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Traffic Volume (Entries)&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Revenue ($)&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Traffic Volume vs Revenue&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Forecast Summary</span></span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">=== 90-Day Revenue Forecast Summary ===&quot;</span>)</span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Average Daily Revenue: $</span><span class="sc">{</span>future_df[<span class="st">&#39;Revenue&#39;</span>]<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Total Projected Revenue: $</span><span class="sc">{</span>future_df[<span class="st">&#39;Revenue&#39;</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Peak Day Revenue: $</span><span class="sc">{</span>future_df[<span class="st">&#39;Revenue&#39;</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Minimum Day Revenue: $</span><span class="sc">{</span>future_df[<span class="st">&#39;Revenue&#39;</span>]<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">=== Weekly Breakdown ===&quot;</span>)</span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a>weekly_summary <span class="op">=</span> future_df.groupby(future_df[<span class="st">&#39;Date&#39;</span>].dt.day_name())[<span class="st">&#39;Revenue&#39;</span>].mean().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(weekly_summary)</span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-91"><a href="#cb25-91" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">=== Monthly Breakdown ===&quot;</span>)</span>
<span id="cb25-92"><a href="#cb25-92" aria-hidden="true" tabindex="-1"></a>monthly_summary <span class="op">=</span> future_df.groupby(future_df[<span class="st">&#39;Date&#39;</span>].dt.month_name())[<span class="st">&#39;Revenue&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(monthly_summary)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_4d12ce75fe99437cb0cb3ffc5455800b/824132266197995e425ef4e0e626e65bdf5709a1.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>
=== 90-Day Revenue Forecast Summary ===
Average Daily Revenue: $736266.33
Total Projected Revenue: $66263969.37
Peak Day Revenue: $770204.49
Minimum Day Revenue: $646197.42

=== Weekly Breakdown ===
Date
Thursday     761955.422540
Friday       761017.670434
Wednesday    759727.101418
Tuesday      747992.957373
Monday       744188.866792
Saturday     702716.377861
Sunday       673685.122528
Name: Revenue, dtype: float64

=== Monthly Breakdown ===
Date
April    2.213478e+07
March    2.198585e+07
May      2.214334e+07
Name: Revenue, dtype: float64
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:567}"
id="qgrySODM1TJv" data-outputId="6d73ff01-6181-4295-d1a5-35a6b9d7d946">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsRegressor</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter post-CRZ and convert date</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>crz_data <span class="op">=</span> combined_crz_traffic_filtered[combined_crz_traffic_filtered[<span class="st">&#39;Date&#39;</span>] <span class="op">&gt;=</span> <span class="st">&#39;2025-01-01&#39;</span>].copy()</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>crz_data[<span class="st">&#39;Date&#39;</span>] <span class="op">=</span> pd.to_datetime(crz_data[<span class="st">&#39;Date&#39;</span>])</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate traffic across streets per day</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>daily_traffic <span class="op">=</span> crz_data.groupby(<span class="st">&#39;Date&#39;</span>)[<span class="st">&#39;Count&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>daily_traffic[<span class="st">&#39;day_of_week&#39;</span>] <span class="op">=</span> daily_traffic[<span class="st">&#39;Date&#39;</span>].dt.dayofweek</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>daily_traffic[<span class="st">&#39;month&#39;</span>] <span class="op">=</span> daily_traffic[<span class="st">&#39;Date&#39;</span>].dt.month</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>daily_traffic[<span class="st">&#39;day_of_year&#39;</span>] <span class="op">=</span> daily_traffic[<span class="st">&#39;Date&#39;</span>].dt.dayofyear</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>daily_traffic[<span class="st">&#39;time_index&#39;</span>] <span class="op">=</span> (daily_traffic[<span class="st">&#39;Date&#39;</span>] <span class="op">-</span> daily_traffic[<span class="st">&#39;Date&#39;</span>].<span class="bu">min</span>()).dt.days</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> daily_traffic[[<span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_year&#39;</span>, <span class="st">&#39;time_index&#39;</span>]]</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> daily_traffic[<span class="st">&#39;Count&#39;</span>]</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale features</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model (choose k = 7 for daily rhythm)</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>knn <span class="op">=</span> KNeighborsRegressor(n_neighbors<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>knn.fit(X_scaled, y)</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate 90 daily future dates</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>future_dates <span class="op">=</span> pd.date_range(start<span class="op">=</span>daily_traffic[<span class="st">&#39;Date&#39;</span>].<span class="bu">max</span>() <span class="op">+</span> pd.Timedelta(days<span class="op">=</span><span class="dv">1</span>), periods<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>future_df <span class="op">=</span> pd.DataFrame({<span class="st">&#39;Date&#39;</span>: future_dates})</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Create same features</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>future_df[<span class="st">&#39;day_of_week&#39;</span>] <span class="op">=</span> future_df[<span class="st">&#39;Date&#39;</span>].dt.dayofweek</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>future_df[<span class="st">&#39;month&#39;</span>] <span class="op">=</span> future_df[<span class="st">&#39;Date&#39;</span>].dt.month</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>future_df[<span class="st">&#39;day_of_year&#39;</span>] <span class="op">=</span> future_df[<span class="st">&#39;Date&#39;</span>].dt.dayofyear</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>future_df[<span class="st">&#39;time_index&#39;</span>] <span class="op">=</span> (future_df[<span class="st">&#39;Date&#39;</span>] <span class="op">-</span> daily_traffic[<span class="st">&#39;Date&#39;</span>].<span class="bu">min</span>()).dt.days</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale and predict</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>X_future <span class="op">=</span> scaler.transform(future_df[[<span class="st">&#39;day_of_week&#39;</span>, <span class="st">&#39;month&#39;</span>, <span class="st">&#39;day_of_year&#39;</span>, <span class="st">&#39;time_index&#39;</span>]])</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>future_df[<span class="st">&#39;Count&#39;</span>] <span class="op">=</span> knn.predict(X_future)</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Historical</span></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>sns.lineplot(data<span class="op">=</span>daily_traffic, x<span class="op">=</span><span class="st">&#39;Date&#39;</span>, y<span class="op">=</span><span class="st">&#39;Count&#39;</span>, label<span class="op">=</span><span class="st">&#39;Historical Traffic&#39;</span>, marker<span class="op">=</span><span class="st">&#39;o&#39;</span>)</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast</span></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>sns.lineplot(data<span class="op">=</span>future_df, x<span class="op">=</span><span class="st">&#39;Date&#39;</span>, y<span class="op">=</span><span class="st">&#39;Count&#39;</span>, label<span class="op">=</span><span class="st">&#39;Forecasted Traffic (Next 90 Days)&#39;</span>, marker<span class="op">=</span><span class="st">&#39;o&#39;</span>)</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Daily Traffic Volume in NYC CRZ (Historical + Forecasted)&quot;</span>)</span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Date&quot;</span>)</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Traffic Volume&quot;</span>)</span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_4d12ce75fe99437cb0cb3ffc5455800b/39cc3a34f8bf7e17d479e06aabbbbadda3b9bdfd.png" /></p>
</div>
</div>
</body>
</html>
